{
  "content": "* webpack的`sideEffect`\n\n在配置css-loader的内部\n\n```\n{\n  test: sassRegex,\n  ...\n  // Don't consider CSS imports dead code even if the\n  // containing package claims to have no side effects.\n  // Remove this when webpack adds a warning or an error for this.\n  // See https://github.com/webpack/webpack/issues/6571\n  sideEffects: true,\n  },\n```\n\n这里有个`sideEffects`配置，sideEffect配置能让开发者去告诉webpack，这里是不是有副作用，\n副作用大概就是指会影响到模块外部内容。\n\n`CRA`这里提出不用去考虑css的摇树优化。\n\n这里给出了一个issue6571，但实际问题应该由\n[https://github.com/facebook/create-react-app/issues/5140](https://github.com/facebook/create-react-app/issues/5140)\n开始。\n\n5140问题提出者指出当他这么使用\n\n`import 'react-octagon/lib/styles/semantic.css'`\n\n在开发模式下没有问题，但生产模式下则这段css都不见了。\n\n经过讨论一番，原因有2点：\n\n1. edmorley提出`react-octagon`在`package.json`内部使用了`sideEffect:false` \n\n    >The react-octagon package has set sideEffects: false in their package.json:\n    https://github.com/Tripwire/octagon/blob/v15.1.2/package.json#L98\n    \n2. `CRA`未对sideEffect进行配置。\n\n这两个问题导致webpack认为这一段`import 'react-octagon/lib/styles/semantic.css'`是一个不含副作用的，\n在摇树优化的时候便将它直接剪掉了。\n\n接着进入`https://github.com/webpack/webpack/issues/6571`问题\n\n这个是在`webpack`库上的问题，提出者认为\n\n`import 'list/fantasy-land'`在`sideEffect:false`的情况下应该被剪掉。\n\n此次的讨论大致观点认为，当`import  xxx`的写法时，是一种暗示有副作用的导入，不应该被`sideEffect`剪掉。\n\n但webpack成员`sokra `[认为](https://github.com/webpack/webpack/issues/6571#issuecomment-425666425)，\n当设置了`sideEffect:false`的情况，再去`import xxx`是一种不正确的写法，并且他认为或许未来添加一个warning是可以接受的。\n\n他也认为所有的CSS文件都应该是有副作用的，因为CSS内部的`import xxx`都是有效的。\n\n至此，`CRA`作者Dan认为，在webpack对这种`import xx`没有提示warning或者error之前，所有CSS内容都认为是有副作用的`sideEffect:true`。\n    "
}
