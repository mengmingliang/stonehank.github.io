{
  "content": "<p>岛屿问题比较通用的算法</p>\n<p>大概思路：</p>\n<ol>\n<li>\n<p>先用dfs求出岛屿</p>\n</li>\n<li>\n<p>再用bfs根据要求算出连通量</p>\n</li>\n</ol>\n<p>以<code>827. Making A Large Island</code>为例</p>\n<p>题目给出一个二维数组，只有<code>0</code>和<code>1</code>，<code>1</code>代表陆地，\n当<code>1</code>周围4个方向(上下左右)有另一个<code>1</code>的时候，可以连接。</p>\n<p>问题是，只能走1步，求出能连接的岛屿的最大值</p>\n<p>例如 :</p>\n<pre class=\"hljs\"><code>[1,1,0]\n[1,0,1]\n[0,1,0]\n</code></pre>\n<p>结果是 6.</p>\n<p>详细思路：</p>\n<ol>\n<li>\n<p>先使用dfs找出所有的岛，并且将其放置到一个Map(islands)中，并且改写grid</p>\n<pre class=\"hljs\"><code>            [2,2,0]\n   grid ==&gt; [2,0,3]\n            [0,4,0]\n</code></pre>\n</li>\n<li>\n<p>检查islands，</p>\n<p>如果length为0，说明一个岛都没有，返回1；</p>\n<p>如果length为1，说明只有1个岛，返回这个岛的<code>length+1</code>或者<code>r*r</code>(<code>length+1&gt;r*r</code>的情况)</p>\n</li>\n<li>\n<p>遍历islands，使用bfs走2步，走完2步后，如果存在不为0并且不是当前岛的，添加到dest</p>\n</li>\n<li>\n<p>检查dest</p>\n<p>如果<code>dest.size===0</code>，说明没有能相互连接的2个岛，选择一个大的岛的<code>length+1</code></p>\n<p>如果<code>dest.size&gt;=1</code>，说明至少有一个能相互连接的2个岛，选择最大的所有能连接的岛的<code>length+1</code></p>\n</li>\n</ol>\n<p>代码：</p>\n<pre class=\"hljs\"><code><span class=\"hljs-keyword\">var</span> largestIsland = <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\">grid</span>) </span>{\n  <span class=\"hljs-keyword\">let</span> r=grid.length,c=r\n  <span class=\"hljs-keyword\">let</span> group=<span class=\"hljs-number\">2</span>\n  <span class=\"hljs-keyword\">let</span> marked=[]\n  <span class=\"hljs-keyword\">for</span>(<span class=\"hljs-keyword\">let</span> i=<span class=\"hljs-number\">0</span>;i&lt;r;i++)marked[i]=[]\n  <span class=\"hljs-keyword\">let</span> islands={}\n  <span class=\"hljs-keyword\">let</span> moves=[[<span class=\"hljs-number\">-1</span>,<span class=\"hljs-number\">0</span>],[<span class=\"hljs-number\">1</span>,<span class=\"hljs-number\">0</span>],[<span class=\"hljs-number\">0</span>,<span class=\"hljs-number\">-1</span>],[<span class=\"hljs-number\">0</span>,<span class=\"hljs-number\">1</span>]]\n  <span class=\"hljs-comment\">// 对应第1步</span>\n  <span class=\"hljs-keyword\">for</span>(<span class=\"hljs-keyword\">let</span> i=<span class=\"hljs-number\">0</span>;i&lt;r;i++){\n    <span class=\"hljs-keyword\">for</span>(<span class=\"hljs-keyword\">let</span> j=<span class=\"hljs-number\">0</span>;j&lt;c;j++){\n      <span class=\"hljs-keyword\">if</span>(grid[i][j]===<span class=\"hljs-number\">1</span>){\n        islands[group]=[]\n        dfs(grid,i,j,marked)\n        group++\n      }\n    }\n  }\n  <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">dfs</span>(<span class=\"hljs-params\">grid,x,y,marked</span>)</span>{\n    <span class=\"hljs-keyword\">if</span>(marked[x][y])<span class=\"hljs-keyword\">return</span>\n    <span class=\"hljs-keyword\">if</span>(grid[x][y]!==<span class=\"hljs-number\">1</span>) <span class=\"hljs-keyword\">return</span>\n    islands[group].push([x,y])\n    marked[x][y]=<span class=\"hljs-literal\">true</span>\n    grid[x][y]=group\n    <span class=\"hljs-keyword\">for</span>(<span class=\"hljs-keyword\">let</span> i=<span class=\"hljs-number\">0</span>;i&lt;moves.length;i++){\n      <span class=\"hljs-keyword\">let</span> nx=x+moves[i][<span class=\"hljs-number\">0</span>],ny=y+moves[i][<span class=\"hljs-number\">1</span>]\n      <span class=\"hljs-keyword\">if</span>(nx&gt;=<span class=\"hljs-number\">0</span> &amp;&amp; nx&lt;r &amp;&amp; ny&gt;=<span class=\"hljs-number\">0</span> &amp;&amp; ny&lt;r) dfs(grid,nx,ny,marked)\n    }\n  }\n  <span class=\"hljs-comment\">// 对应第2步</span>\n  <span class=\"hljs-keyword\">let</span> vals=<span class=\"hljs-built_in\">Object</span>.values(islands)\n  <span class=\"hljs-keyword\">if</span>(vals.length===<span class=\"hljs-number\">0</span>)<span class=\"hljs-keyword\">return</span> <span class=\"hljs-number\">1</span>\n  <span class=\"hljs-keyword\">if</span>(vals.length===<span class=\"hljs-number\">1</span>)<span class=\"hljs-keyword\">return</span> vals[<span class=\"hljs-number\">0</span>].length+<span class=\"hljs-number\">1</span>&gt;r*r?r*r:vals[<span class=\"hljs-number\">0</span>].length+<span class=\"hljs-number\">1</span>\n  \n  <span class=\"hljs-keyword\">let</span> connected=<span class=\"hljs-number\">0</span>\n  <span class=\"hljs-comment\">// 对应第3步</span>\n  <span class=\"hljs-keyword\">for</span>(<span class=\"hljs-keyword\">let</span> k <span class=\"hljs-keyword\">in</span> islands){\n    <span class=\"hljs-keyword\">let</span> path=<span class=\"hljs-number\">0</span>\n    <span class=\"hljs-keyword\">let</span> bfs=islands[k].slice()\n    <span class=\"hljs-keyword\">while</span>(bfs.length&gt;<span class=\"hljs-number\">0</span>){\n      <span class=\"hljs-keyword\">let</span> len=bfs.length\n      <span class=\"hljs-keyword\">if</span>(path&gt;=<span class=\"hljs-number\">2</span>)<span class=\"hljs-keyword\">break</span>\n      <span class=\"hljs-keyword\">for</span>(<span class=\"hljs-keyword\">let</span> i=<span class=\"hljs-number\">0</span>;i&lt;len;i++){\n        <span class=\"hljs-keyword\">let</span> cur=bfs.shift()\n        <span class=\"hljs-keyword\">let</span> x=cur[<span class=\"hljs-number\">0</span>],y=cur[<span class=\"hljs-number\">1</span>]\n        <span class=\"hljs-keyword\">let</span> dest=<span class=\"hljs-keyword\">new</span> <span class=\"hljs-built_in\">Set</span>()\n        <span class=\"hljs-keyword\">for</span>(<span class=\"hljs-keyword\">let</span> j=<span class=\"hljs-number\">0</span>;j&lt;moves.length;j++){\n          <span class=\"hljs-keyword\">let</span> nX=x+moves[j][<span class=\"hljs-number\">0</span>],nY=y+moves[j][<span class=\"hljs-number\">1</span>]\n          <span class=\"hljs-keyword\">if</span>(nX&lt;<span class=\"hljs-number\">0</span> || nX&gt;=r|| nY&lt;<span class=\"hljs-number\">0</span> || nY&gt;=r)<span class=\"hljs-keyword\">continue</span>\n          <span class=\"hljs-keyword\">if</span>(grid[nX][nY]!==<span class=\"hljs-number\">0</span> &amp;&amp; grid[nX][nY]!== +k &amp;&amp; path===<span class=\"hljs-number\">1</span>)dest.add(grid[nX][nY])\n          <span class=\"hljs-keyword\">if</span>(grid[nX][nY]===<span class=\"hljs-number\">0</span>)bfs.push([nX,nY])\n        }\n        <span class=\"hljs-comment\">// 对应第4步</span>\n        <span class=\"hljs-keyword\">if</span>(dest.size===<span class=\"hljs-number\">0</span>)connected=<span class=\"hljs-built_in\">Math</span>.max(connected,islands[k].length+<span class=\"hljs-number\">1</span>)\n        <span class=\"hljs-keyword\">if</span>(dest.size&gt;=<span class=\"hljs-number\">1</span>){\n          <span class=\"hljs-keyword\">let</span> curCount=islands[k].length,sum=<span class=\"hljs-number\">0</span>\n          <span class=\"hljs-keyword\">for</span>(<span class=\"hljs-keyword\">let</span> n <span class=\"hljs-keyword\">of</span> dest)sum+=islands[n].length\n          connected=<span class=\"hljs-built_in\">Math</span>.max(connected,sum+<span class=\"hljs-number\">1</span>+curCount)\n        }\n      }\n      path++\n    }\n  }\n  <span class=\"hljs-keyword\">return</span> connected \n};\n</code></pre>\n"
}
