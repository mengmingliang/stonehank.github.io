{
  "content": "<h2>一个记录redux每次dispatch耗时中间件</h2>\n<h3>源码</h3>\n<p><a href=\"https://gist.github.com/clarkbw/966732806e7a38f5b49fd770c62a6099\">源码地址</a></p>\n<pre class=\"hljs\"><code><span class=\"hljs-keyword\">const</span> timing = <span class=\"hljs-function\"><span class=\"hljs-params\">store</span> =&gt;</span> next =&gt; <span class=\"hljs-function\"><span class=\"hljs-params\">action</span> =&gt;</span> {\n  <span class=\"hljs-keyword\">if</span>(performance.mark===<span class=\"hljs-literal\">undefined</span>) <span class=\"hljs-keyword\">return</span> next(action)\n  performance.mark(<span class=\"hljs-string\">`<span class=\"hljs-subst\">${action.type}</span>_start`</span>);\n  <span class=\"hljs-keyword\">let</span> result = next(action);\n  performance.mark(<span class=\"hljs-string\">`<span class=\"hljs-subst\">${action.type}</span>_end`</span>);\n  performance.measure(\n    <span class=\"hljs-string\">`<span class=\"hljs-subst\">${action.type}</span>`</span>,\n    <span class=\"hljs-string\">`<span class=\"hljs-subst\">${action.type}</span>_start`</span>,\n    <span class=\"hljs-string\">`<span class=\"hljs-subst\">${action.type}</span>_end`</span>\n  );\n  <span class=\"hljs-keyword\">return</span> result;\n};\n</code></pre>\n<hr>\n<h3>使用</h3>\n<p>如果需要记录包括中间件和dispatch的耗时，放在<code>applyMiddleWare</code>最前面：</p>\n<p><code>applyMiddleWare(timing,thunk,...milldeware)</code></p>\n<p>如果只记录dispatch的，放在最后面：</p>\n<p><code>applyMiddleWare(thunk,middleware1,...,timing)</code></p>\n<p>然后可以通过<code>performance.getEntriesByType('measure')</code>获取所有耗时的集合(Array)。</p>\n"
}
