{
  "content": "<p>indexedDB\n在客户端进行保存保存：</p>\n<pre class=\"hljs\"><code>{id: 1, name: &quot;张三&quot;, age: 24, email: &quot;zhangsan@example.com&quot;}\n{id: 2, name: &quot;李四&quot;, age: 54, email: &quot;lisi@example.com&quot;}\n{id: 3, name: &quot;王五&quot;, age: 36, email: &quot;wangwu@example.com&quot;}\n</code></pre>\n<ul>\n<li>步骤1-创建数据库</li>\n</ul>\n<pre class=\"hljs\"><code><span class=\"hljs-keyword\">var</span> request = <span class=\"hljs-built_in\">window</span>.indexedDB.open(<span class=\"hljs-string\">\"test\"</span>, <span class=\"hljs-number\">1</span>);\n<span class=\"hljs-keyword\">var</span> db\n</code></pre>\n<ul>\n<li>步骤2-创建数据表，添加初始数据</li>\n</ul>\n<pre class=\"hljs\"><code>request = <span class=\"hljs-built_in\">window</span>.indexedDB.open(<span class=\"hljs-string\">\"test\"</span>, <span class=\"hljs-number\">1</span>);\nrequest.onupgradeneeded=<span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\">e</span>)</span>{\n  db = e.target.result;\n  <span class=\"hljs-keyword\">var</span> objectStore;\n  <span class=\"hljs-keyword\">if</span> (!db.objectStoreNames.contains(<span class=\"hljs-string\">'person'</span>)) {\n    objectStore = db.createObjectStore(<span class=\"hljs-string\">'person'</span>, { <span class=\"hljs-attr\">keyPath</span>: <span class=\"hljs-string\">'id'</span> });\n  }\nobjectStore.add({<span class=\"hljs-attr\">id</span>: <span class=\"hljs-number\">1</span>, <span class=\"hljs-attr\">name</span>: <span class=\"hljs-string\">\"张三\"</span>, <span class=\"hljs-attr\">age</span>: <span class=\"hljs-number\">24</span>, <span class=\"hljs-attr\">email</span>: <span class=\"hljs-string\">\"zhangsan@example.com\"</span>})\n}\n</code></pre>\n<ul>\n<li>步骤3-增加数据</li>\n</ul>\n<pre class=\"hljs\"><code>  add()\n<span class=\"hljs-comment\">// db存在</span>\n<span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">add</span>(<span class=\"hljs-params\"></span>)</span>{\n  <span class=\"hljs-keyword\">var</span> addReq\n  <span class=\"hljs-keyword\">var</span> tra=db.transaction([<span class=\"hljs-string\">'person'</span>],<span class=\"hljs-string\">'readwrite'</span>)\n  <span class=\"hljs-keyword\">var</span> objS=tra.objectStore(<span class=\"hljs-string\">'person'</span>)\n  addReq=objS.add({<span class=\"hljs-attr\">id</span>: <span class=\"hljs-number\">2</span>, <span class=\"hljs-attr\">name</span>: <span class=\"hljs-string\">\"李四\"</span>, <span class=\"hljs-attr\">age</span>: <span class=\"hljs-number\">54</span>, <span class=\"hljs-attr\">email</span>: <span class=\"hljs-string\">\"lisi@example.com\"</span>})\n  addReq=objS.add({<span class=\"hljs-attr\">id</span>: <span class=\"hljs-number\">3</span>, <span class=\"hljs-attr\">name</span>: <span class=\"hljs-string\">\"王五\"</span>, <span class=\"hljs-attr\">age</span>: <span class=\"hljs-number\">36</span>, <span class=\"hljs-attr\">email</span>: <span class=\"hljs-string\">\"wangwu@example.com\"</span>})\n  addReq.onsuccess = <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">event</span>) </span>{\n    <span class=\"hljs-built_in\">console</span>.log(<span class=\"hljs-string\">'数据写入成功'</span>);\n  };\n\n  addReq.onerror = <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">event</span>) </span>{\n    <span class=\"hljs-built_in\">console</span>.log(<span class=\"hljs-string\">'数据写入失败'</span>);\n  }\n}\n\n</code></pre>\n<ul>\n<li>步骤4-查找数据表</li>\n</ul>\n<pre class=\"hljs\"><code>request = <span class=\"hljs-built_in\">window</span>.indexedDB.open(<span class=\"hljs-string\">\"test\"</span>, <span class=\"hljs-number\">1</span>);\nrequest.onsuccess=<span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\">e</span>)</span>{\n  db=e.target.result\n  <span class=\"hljs-keyword\">var</span> tra=db.transaction([<span class=\"hljs-string\">'person'</span>])\n  <span class=\"hljs-keyword\">var</span> objS=tra.objectStore(<span class=\"hljs-string\">'person'</span>)\n  <span class=\"hljs-built_in\">console</span>.log(objS.getAll().result)\n}\n</code></pre>\n<p>参考：<a href=\"https://wangdoc.com/javascript/bom/indexeddb.html\">https://wangdoc.com/javascript/bom/indexeddb.html</a></p>\n"
}
