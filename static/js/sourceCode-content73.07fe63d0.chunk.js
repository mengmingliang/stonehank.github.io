(window.webpackJsonp=window.webpackJsonp||[]).push([[726],{1124:function(n){n.exports={content:'<h2>\u5173\u4e8eConsumer\u7684\u8865\u5145</h2>\n<p>\u5b98\u65b9\uff08\u82f1\u6587\uff09\uff1a</p>\n<blockquote>\n<p>All Consumers that are descendants of a Provider will re-render whenever the Provider\u2019s value prop changes.\nThe propagation from Provider to its descendant Consumers is not subject to the shouldComponentUpdate method,\nso the Consumer is updated even when an ancestor component bails out of the update.</p>\n</blockquote>\n<blockquote>\n<p>Changes are determined by comparing the new and old values using the same algorithm as Object.is.</p>\n</blockquote>\n<p>\u5927\u6982\u7ffb\u8bd1\uff1a</p>\n<p>\u6bcf\u5f53 Provider \u7684value\u53d1\u751f\u6539\u53d8\u65f6\uff0c\u5176\u5185\u90e8\u6240\u6709\u7684 Consumers \u90fd\u5c06\u4f1a\u91cd\u65b0\u6e32\u67d3\u3002\u8fd9\u79cd\u6539\u53d8\u4e0d\u4f1a\u53d7\u5230shouldComponentUpdate\u65b9\u6cd5\u5f71\u54cd\uff0c\n\u56e0\u6b64\u5373\u4f7f\u7ec4\u4ef6\u53d6\u6d88\u4e86\u66f4\u65b0\uff0c\u4f46\u662fConsumer\u8fd8\u662f\u4f1a\u7ee7\u7eed\u6e32\u67d3\u3002</p>\n<p>Consumer\u662f\u901a\u8fc7\u4f7f\u7528\u76f8\u540c\u7684\u7b97\u6cd5\u5982Object.is\u6bd4\u8f83\u65b0\u65e7\u503c\u6765\u786e\u5b9a\u53d8\u5316\u3002</p>\n<hr>\n<p>\u8fd9\u4e2a\u7279\u6027\u5728\u6e90\u7801\u4e2d\u8fd9\u4e48\u4f53\u73b0\uff1a</p>\n<pre class="hljs"><code>let Location = ({ children }) =&gt; (\n\n  &lt;LocationContext.Consumer&gt;\n    {context =&gt;\n      context ? (\n      // \u540e\u9762\u7ee7\u7eed\u521b\u5efa\u65f6\uff08\u5d4c\u5957\uff09\uff0ccontext\u4f1a\u52a8\u6001\u968f\u7740\u7236\u7ea7\u7684Provider\u66f4\u65b0\uff0c\u56e0\u6b64\u76f4\u63a5\u8c03\u7528children\n        children(context)\n      ) : (\n      // \u7b2c\u4e00\u6b21\u521b\u5efa\u65f6 context \u65e0\u503c\uff0c\u521b\u5efa LocationProvider\n        &lt;LocationProvider&gt;{children}&lt;/LocationProvider&gt;\n      )\n    }\n  &lt;/LocationContext.Consumer&gt;\n);\n</code></pre>\n<p>\u8fd9\u4e2aLocation\u7ec4\u4ef6\u8fd4\u56de\u503c\u662f\u4e00\u4e2a<code>createContext(/* \u65e0\u53c2\u6570*/)</code>\u7684<code>Consumer</code>\uff0c\u5f53\u4f7f\u7528\u7ec4\u4ef6\u65f6<code>Router/Link/Redirect/Match</code>\uff0c\u5b83\u90fd\u5728\u5185\u90e8\u3002</p>\n<p>\u56e0\u6b64\u7b2c\u4e00\u6b21\u521b\u5efa\u5728<code>Router\u7ec4\u4ef6</code>\u5185\u90e8\u7684\u65f6\u5019\uff0c<code>context</code>\u662fundefined\uff0c\u4f1a\u521b\u5efa<code>LocationProvider\u7ec4\u4ef6</code>\uff0c\nLocationProvider\u7ec4\u4ef6\u5c31\u662f\u5bf9\u5e94\u7684<code>Provider</code>\uff0c\u5e76\u4e14\u5185\u90e8\u4f1a\u83b7\u53d6\u5230\u516c\u5171\u4f7f\u7528\u7684\u8df3\u8f6c\u65b9\u6cd5<code>navigate</code>\u548c\u5f53\u524durl\u7684\u4fe1\u606f<code>location</code>\u4f5c\u4e3a\u5b83\u7684value\u3002</p>\n<p>\u800c\u5f53<code>Route Component</code>\u5185\u90e8\u7ee7\u7eed\u5d4c\u5957<code>Router</code>\u7684\u65f6\u5019\uff0ccontext\u4f1a\u83b7\u53d6\u5230<code>Provider</code>\u7684value\u503c\uff0c\u56e0\u6b64\u76f4\u63a5\u8c03\u7528<code>children(context)</code></p>\n<p>\u7ed3\u6784\u5982\u4e0b\uff1a</p>\n<pre class="hljs"><code>class App extends Component{\n    /*...*/\n    return (\n        // \u6700\u5916\u5c42\u7684Location\uff0c\u521b\u5efa LocationProvider\u7ec4\u4ef6\n        &lt;Router&gt;\n            &lt;Home path=&quot;...&quot; /&gt;\n            &lt;Details path=&quot;...&quot;  /&gt;\n        &lt;/Router&gt;\n    )\n}\n\nclass Details extends Component{\n    /*...*/\n    return (\n        // \u5d4c\u5957\u7684Location\uff0c\u76f4\u63a5\u8c03\u7528children(context)\n        // \u8fd9\u91ccchildren\u662f\u4e00\u4e2a\u53c2\u6570\u662fcontext\u7684\u51fd\u6570\n        &lt;Link to=&quot;...&quot; &gt;Details-1&lt;/Link&gt;\n    )\n}\n</code></pre>\n<h2>Promise.resolve().then</h2>\n<p>\u6e90\u7801\u4e2d\u770b\u5230\u8fd9\u79cd\u8bed\u53e5\uff1a</p>\n<pre class="hljs"><code>Promise.resolve().then(() =&gt; {\n      navigate(insertParams(to, props), { replace, state });\n    });\n</code></pre>\n<p>\u4e4b\u524d\u5e76\u672a\u89c1\u8fc7\uff0c\u89c9\u5f97\u8fd9\u4e0d\u5c31\u662f\u4e2aPromise\u7acb\u5373\u5b8c\u6210\u7684\u5f02\u6b65\u5417\uff0c\u4e3a\u4ec0\u4e48\u4e0d\u4f7f\u7528<code>setTimeout(()=&gt;{},0)</code>\uff0c\u6709\u4ec0\u4e48\u533a\u522b\u5462</p>\n<pre class="hljs"><code>setTimeout(<span class="hljs-function"><span class="hljs-params">()</span>=&gt;</span>{\n  <span class="hljs-built_in">console</span>.log(<span class="hljs-number">1</span>)\n},<span class="hljs-number">0</span>);\n\n<span class="hljs-built_in">Promise</span>.resolve().then(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> {\n  <span class="hljs-built_in">console</span>.log(<span class="hljs-number">2</span>)\n    });\n<span class="hljs-comment">// 2</span>\n<span class="hljs-comment">// 1</span>\n</code></pre>\n<p>Promise\u7684\u4efb\u52a1\u4f1a\u6dfb\u52a0\u5230\u5f53\u524d\u4efb\u52a1\u961f\u5217\u7684\u672b\u5c3e\uff0c\u800csetTimeout\u4e2d\u7684\u4efb\u52a1\u662f\u653e\u5230\u4e0b\u4e00\u4e2a\u4e8b\u4ef6\u5faa\u73af\u5217\u8868\u6267\u884c</p>\n<p>\u4e00\u5f20\u56fe\u7406\u89e3\uff1a\n<img src="https://stonehank.github.io/articles/img/eventloop%20and%20callbackqueue.png" alt=""></p>\n<p>\u7b80\u5355\u6765\u8bf4\uff0cPromise\u5c31\u662f\u5f02\u6b65\uff0c\u8d8a\u5feb\u8d8a\u597d</p>\n'}}}]);
//# sourceMappingURL=sourceCode-content73.07fe63d0.chunk.js.map