(window.webpackJsonp=window.webpackJsonp||[]).push([[42],{1163:function(s){s.exports={content:'<h2>Reselect</h2>\n<p>\u5f53\u6211\u4eec\u4f7f\u7528redux\u7684<code>connect(mapStateToProps)</code>\u7684\u65f6\u5019</p>\n<p>\u6709\u65f6\u5019store\u7684\u6570\u636e\u76f4\u63a5\u4f20\u8fdb\u7ec4\u4ef6\u5e76\u4e0d\u597d\uff0c\u4e8e\u662f\u6211\u4eec\u5e0c\u671b\u5728\u5c06\u6570\u636e\u4f20\u8fdb\u7ec4\u4ef6\u524d\uff0c\u8fdb\u884c\u8c03\u6574</p>\n<p>\u4f8b\u5982 store\u5982\u4e0b</p>\n<pre class="hljs"><code>const mockStore={\n  descriptions:[\n    {name:&quot;a&quot;,age:25},\n    {name:&quot;b&quot;,age:38},\n    {name:&quot;c&quot;,age:26}\n  ]\n}\n</code></pre>\n<p>\u6211\u4eec\u5e0c\u671b\u4f20\u8fdb\u7ec4\u4ef6\u7684\u6570\u636e\u5982\u4e0b\uff1a</p>\n<pre class="hljs"><code>{\n  descriptions:{\n    name:[&quot;a&quot;,&quot;b&quot;,&quot;c&quot;],\n    age:[25,38,26]\n  }\n}\n</code></pre>\n<p>\u901a\u5e38\u7684\u529e\u6cd5\uff1a</p>\n<pre class="hljs"><code><span class="hljs-keyword">const</span> mapStateToProps=<span class="hljs-function">(<span class="hljs-params">state</span>)=&gt;</span>{\n  <span class="hljs-keyword">const</span> newDescriptions={}\n  state.descriptions.forEach(<span class="hljs-function">(<span class="hljs-params">obj</span>)=&gt;</span>{\n    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">let</span> key <span class="hljs-keyword">in</span> obj){\n      <span class="hljs-keyword">if</span>(obj.hasOwnProperty(key)){\n        <span class="hljs-keyword">if</span>(!newDescriptions[key]){\n          newDescriptions[key]=[]\n        }\n        newDescriptions[key].push(obj[key])\n      }\n    }\n  })\n  <span class="hljs-keyword">return</span> {<span class="hljs-attr">descriptions</span>:newDescriptions}\n}\n<span class="hljs-built_in">console</span>.log(mapStateToProps(mockStore)===mapStateToProps(mockStore))\n<span class="hljs-comment">// false</span>\n</code></pre>\n<p>\u7f3a\u9677\uff1a\u5f88\u660e\u663e\u8fd9\u91cc\u6bcf\u6b21\u6267\u884c\u90fd\u4f1a\u8fd4\u56de\u4e00\u4e2a\u5168\u65b0\u7684\u5bf9\u8c61\uff0c\u56e0\u6b64redux\u7684\u6d45\u5bf9\u6bd4\u5c31\u4f1a\u5931\u6548\uff0c\u9020\u6210\u591a\u6b21\u91cd\u590d\u6e32\u67d3</p>\n<p>\u4f7f\u7528reselect</p>\n<pre class="hljs"><code><span class="hljs-keyword">import</span> {createSelector} <span class="hljs-keyword">from</span> <span class="hljs-string">\'reselect\'</span>\n\n<span class="hljs-keyword">const</span> selectState=createSelector(\n  <span class="hljs-function"><span class="hljs-params">state</span>=&gt;</span>state.descriptions,\n  descriptions=&gt;{\n    <span class="hljs-keyword">const</span> newDescriptions={}\n    descriptions.forEach(<span class="hljs-function">(<span class="hljs-params">obj</span>)=&gt;</span>{\n      <span class="hljs-keyword">for</span>(<span class="hljs-keyword">let</span> key <span class="hljs-keyword">in</span> obj){\n        <span class="hljs-keyword">if</span>(obj.hasOwnProperty(key)){\n          <span class="hljs-keyword">if</span>(!newDescriptions[key]){\n            newDescriptions[key]=[]\n           }\n           newDescriptions[key].push(obj[key])\n        }\n      }\n    })\n    <span class="hljs-keyword">return</span> {<span class="hljs-attr">descriptions</span>:newDescriptions}\n  }\n)\n<span class="hljs-built_in">console</span>.log(selectState(mockStore)===selectState(mockStore))\n<span class="hljs-comment">// true</span>\n</code></pre>\n<p>\u901a\u8fc7\u6d4b\u8bd5\uff0c\u4f1a\u53d1\u73b0\uff0c\u6bcf\u6b21\u7684\u8fd4\u56de\u503c\u90fd\u662f\u5f15\u7528\u76f8\u7b49\u7684(===)\uff0c\u539f\u56e0\u662f\u56e0\u4e3areselect\u5185\u90e8\u4f7f\u7528\u4e86\u7f13\u5b58\uff0c\n\u5f53\u53c2\u6570(mockStore)\u76f8\u540c\uff0c\u76f4\u63a5\u8fd4\u56de\u7f13\u5b58\u7684\u7ed3\u679c</p>\n<p>\u6ce8\u610f\uff1a\u6bd4\u8f83\u53c2\u6570\u662f\u5efa\u7acb\u5728\u6211\u4eec\u7f16\u5199<em>\u7eaf\u51fd\u6570</em>\u7684\u57fa\u7840\u4e0a\uff0c\u5982\u679c\u5185\u90e8\u4e0d\u662f\u7eaf\u51fd\u6570\uff0c\u4f46\u53c2\u6570\u76f8\u540c\uff0c\u4e5f\u4f1a\u8fd4\u56de\u7f13\u5b58\u503c\uff0c\u5c31\u5f88\u53ef\u80fd\u4f1a\u9020\u6210\u610f\u5916\u7684bug</p>\n<p><a href="https://gist.github.com/stonehank/c5de2a4318ee9954503770047c998c7b">\u8be6\u7ec6\u4ee3\u7801</a></p>\n<p><a href="https://github.com/stonehank/sourcecode-analysis/blob/master/source-code.reselect/README.md">\u66f4\u591a\u5173\u4e8ereselect\u7684\u5b66\u4e60</a></p>\n'}}}]);
//# sourceMappingURL=sourceCode-content113.1f4c38b6.chunk.js.map