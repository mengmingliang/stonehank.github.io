(window.webpackJsonp=window.webpackJsonp||[]).push([[54],{1174:function(e){e.exports={content:'<h2>\u4e00\u6b21xhr.upload.onprogress\u4e0emultiparty\u642d\u914d\u7684\u8e29\u5751\u8bb0\u5f55</h2>\n<p>\u6709\u4e00\u4e2a<a href="https://github.com/stonehank/blogs/blob/master/07-26-%E9%80%9A%E8%BF%87blob%E5%AE%9E%E7%8E%B0%E6%96%87%E4%BB%B6%E7%BB%AD%E4%BC%A0%E8%AE%B0%E5%BD%95(nodejs).md">\u5206\u6bb5\u4e0a\u4f20\u7684demo</a>\uff0c\u8bbe\u5b9a\u6bcf\u6b21\u4e0a\u4f20\u5927\u5c0f\u4e3a1MB\uff0c\u4f46\u5f53\u7f51\u901f\u8fc7\u6162\u7684\u65f6\u5019\uff0c\u8fdb\u5ea6\u6761\u4f1a\u7b49\u5f85\u5f88\u4e45(1MB\u4e0a\u4f20\u5b8c\u6bd5)\n\u624d\u4f1a\u589e\u52a0\u53d8\u5316\uff0c\u4e8e\u662f\u60f3\u901a\u8fc7<code>xhr.onprogress</code>\u5bf9\u5176\u8fdb\u884c\u5b9e\u65f6\u76d1\u63a7</p>\n<p>\u56e0\u4e3a\u662f\u4e0a\u4f20\u6587\u4ef6\uff0c\u9700\u8981\u4f7f\u7528<code>xhr.upload.onprogress</code>\uff0c\u4f46\u4f1a\u53d1\u51fa\u8de8\u57df\u9519\u8bef</p>\n<p>\u539f\u6765<code>xhr.upload.onprogress</code>\u4f1a\u88ab\u8ba4\u4e3a\u662f\u4e00\u4e2a\u975e\u7b80\u5355\u8bf7\u6c42\uff0c\u9700\u8981\u9884\u68c0\u8bf7\u6c42\uff0c\u800c\u9884\u68c0\u8bf7\u6c42\u662f\u4e00\u4e2aOPTIONS\u65b9\u6cd5\uff0c\u9ed8\u8ba4\u7684\u8de8\u57df\u914d\u7f6e\u5e76\u4e0d\u652f\u6301OPTIONS\u65b9\u6cd5</p>\n<p>\u8fd9\u5c31\u662f\u95ee\u9898\u539f\u56e0</p>\n<p>\u89e3\u51b3\u529e\u6cd5\uff1a</p>\n<p>\u9996\u5148\u8981\u5728\u670d\u52a1\u7aef\u6dfb\u52a0OPTIONS\u5904\u7406\u65b9\u6cd5</p>\n<p><code>res.setHeader(&quot;Access-Control-Allow-Methods&quot;, &quot;POST, GET, OPTIONS&quot;)</code></p>\n<p>\u7ed3\u679c\u8fd8\u662f\u4e0d\u884c\uff0c\u67e5\u770b\u62a5\u9519\u4fe1\u606f(\u6b64\u5904\u4f7f\u7528\u4e86<code>multiparty</code>\u5bf9<code>formData</code>\u89e3\u6790)</p>\n<pre class="hljs"><code>Error: missing content-type header\n</code></pre>\n<p>\u539f\u6765\u5728<code>multiparty</code>\u5185\u90e8\u4f7f\u7528<code>form.parse(req)</code>\u65f6\u4f1a\u68c0\u6d4b<code>content-type</code>\uff0c\u800coptions\u8bf7\u6c42\u4e0d\u5e26<code>content-type</code>\uff0c\u56e0\u6b64\u4f1a\u89e6\u53d1\u9519\u8bef</p>\n<p>\u5c1d\u8bd51\uff1a\u5728client\u5185\u90e8\u8fdb\u884c\u6dfb\u52a0<code>xhr.setRequestHeader(\'content-type\', \'multipart/form-data\')</code>\uff0c\u4f46\u662foptions\u5e76\u4e0d\u4f1a\u5e26\u4e0a\u8fd9\u4e2acontent-type</p>\n<p>\u6700\u7ec8\u89e3\u51b3\uff1a\u91c7\u53d6\u5f53method\u4e3a<code>OPTIONS</code>\u65f6\uff0c\u76f4\u63a5\u8fd4\u56de204</p>\n<pre class="hljs"><code><span class="hljs-keyword">if</span>(req.method===<span class="hljs-string">"OPTIONS"</span>){\n    res.statusCode=<span class="hljs-number">204</span>\n    res.end()\n  }<span class="hljs-keyword">else</span>{\n  <span class="hljs-comment">//\u6b64\u5904\u4f1a\u68c0\u6d4bcontent-type\uff0c\u800coptions\u8bf7\u6c42\u4e0d\u5e26content-type\uff0c\u56e0\u6b64\u4f1a\u89e6\u53d1\u9519\u8bef</span>\n    form.parse(req)\n  }\n</code></pre>\n'}}}]);
//# sourceMappingURL=sourceCode-content124.2d4752c8.chunk.js.map